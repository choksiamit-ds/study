
 Tables :  filter   nat   mangle   raw   


 Options :  -A(append)   -I(insert)   -D(delete)   -R(replace)   
-F(flush)   -Z(zero)   -L(list)   -S(show)   
-N   -X   

 Chains :  INPUT   OUTPUT   FORWARD   PRE_ROUTING   
POST_ROUTING   USER_DEFINED   

 Matches :  -s source_ip   -d dest_ip   -p protocol   --sport source_p   
--dport dest_p   -p icmp   --icmp-type   -i incoming_intf   
-o outgoing_intf   -m mac   -m time   -m quota   
-m limit   -m recent   

 Target/Jump :  ACCEPT   DROP   REJECTLOG   SNAT   
DNAT   MASQUERATE   LIMITTEE   TOS   
TTL   


 Basic Usage: 
 iptables [-t table_name]-COMMAND CHAIN_NAME matches -j TARGET


 Drop ICMP echo packets: 
 iptables -t filter -A INPUT -p icmp --icmp-type echo -j DROP


 Print all iptables: 
 iptables -nvL


 Drop outgoing http traffic to specific target
 iptables -t filter -A OUTPUT -p tcp --dport 80 -d www.ubuntu.com -j DROP
 iptables -t filter -A OUTPUT -p tcp --dport 443 -d www.ubuntu.com -j DROP


 Drop smtp incoming traffic on 1.1.1.1
 iptables -A INPUT -p tcp --dport 25 -j DROP


 Scan the port using nmap from another machine
 nmap -p 25 1.1.1.1


 Drop incoming traffic tftp 69 port insert at pos 0
 iptables -I INPUT -p udp --dport 69 -j DROP


 Drop incoming traffic tftp 69 port insert on 3rd position
 iptables -I INPUT 3 -p udp --dport 69 -j DROP


 List all rules
 iptables -nvL iptables -L iptables -nL



